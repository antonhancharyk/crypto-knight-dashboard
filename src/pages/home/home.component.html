<div>
  <div class="container_spinner_over" *ngIf="isLoadingKlines() || isLoadingTracks()">
    <mat-spinner></mat-spinner>
  </div>

  <div class="container">
    <div class="container_total_info">
      <div class="container__info">
        <span>ğŸš€</span>
        <span>{{ countPositions() }}</span
        >| <span>â¬†ï¸{{ countLongPositions() }}</span
        >| <span>â¬‡ï¸{{ countShortPositions() }}</span
        >| <span class="good-positions">{{ countGoodPositions() }}</span
        >|
        <span class="bad-positions">{{ countBadPositions() }}</span>
      </div>

      <div class="container__info">
        <span>ğŸ¦</span>
        <span>Balance: {{ balance()?.balance | number: '1.2-2' }}</span
        >| <span>Unrealized: {{ balance()?.crossUnPnl | number: '1.2-2' }}</span
        >|
        <span
          >Potential:
          {{ +(balance()?.balance || 0) + +(balance()?.crossUnPnl || 0) | number: '1.2-2' }}</span
        >
      </div>

      <div class="container__info">
        <span>ğŸ</span>
        <span
          >Free balance: {{ distributedBalance()?.freeBalanceNewPosition | number: '1.2-2' }}</span
        >|
        <span
          >Available positions:
          {{
            (distributedBalance()?.freeBalanceNewPosition || 0) / positionSize() | number: '1.0-0'
          }}</span
        >| <span>Position size: {{ positionSize() | number: '1.2-2' }}</span>
      </div>
    </div>

    <div class="tracks">
      <ng-container *ngFor="let track of tracks(); let i = index">
        <mat-card
          class="mat-card"
          [ngClass]="{
            long: track.isPosition && isLong(track),
            short: track.isPosition && !isLong(track),
          }"
          [ngStyle]="{ 'background-color': track.stopPrice || !track.isPosition ? '' : 'red' }"
        >
          <div class="mat-card-header">
            <div>
              <span>{{ track.symbol.slice(0, -4) }}</span>
              <span class="chart-icon" (click)="openKlineChart(track)">ğŸ“ˆ</span>
            </div>
            <span class="highlighted1">{{ getPrice(track.symbol) }}</span>
          </div>

          <div *ngIf="track.isPosition">
            <div class="container_order_data">
              <mat-card-content>â›©ï¸{{ track.entryPrice | number: '1.2-6' }}</mat-card-content>
              <div class="mat-card-header">
                <span
                  class="highlighted1"
                  [style]="{ color: getFormattedColorPositionPercentageDiff(track) }"
                >
                  {{ getFormattedPositionPercentageDiff(track) }}
                </span>
              </div>
            </div>
          </div>

          <div class="container_data">
            <div *ngIf="track.isPosition" class="price">
              <mat-card-content
                >ğŸ¦{{ +(track.initialMargin || '') | number: '1.2-2' }}</mat-card-content
              >
            </div>

            <div *ngIf="track.isPosition" class="price">
              <mat-card-content
                >ğŸ’µ{{ +(track.unRealizedProfit || '') | number: '1.2-2' }}</mat-card-content
              >
            </div>

            <div *ngIf="track.highPrice" class="price">
              <mat-card-content>â¬†ï¸{{ track.highPrice | number: '1.2-6' }}</mat-card-content>
            </div>

            <div *ngIf="track.lowPrice" class="price">
              <mat-card-content>â¬‡ï¸{{ track.lowPrice | number: '1.2-6' }}</mat-card-content>
            </div>

            <div *ngIf="track.middlePrice" class="price">
              <mat-card-content>ğŸ{{ track.middlePrice | number: '1.2-6' }}</mat-card-content>
            </div>

            <div *ngIf="track.stopPrice" class="price">
              <mat-card-content>ğŸ›‘{{ track.stopPrice | number: '1.2-6' }}</mat-card-content>
            </div>
          </div>
        </mat-card>

        <div
          *ngIf="tracks()[i].isPosition && tracks()[i + 1] && !tracks()[i + 1].isPosition"
          class="divider donotcross"
        >
          Tracks
        </div>
      </ng-container>
    </div>
  </div>
</div>
